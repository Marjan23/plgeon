Inherits some ugliness from BIP 70, but seems reasonable otherwise. --Luke Dashjr, 2016-12-23